DROP DATABASE IF EXISTS ELCIELODB2025;

CREATE DATABASE ELCIELODB2025;

USE ELCIELODB2025;

CREATE TABLE HABITACION (
 IDE_HAB INT NOT NULL auto_increment,
 TIP_HAB VARCHAR(15) NOT NULL,
 EST_HAB VARCHAR(12) NOT NULL,
 NUM_HAB INT NOT NULL,
 PIS_HAB INT NOT NULL,
 PRE_HAB DECIMAL(10,2) NOT NULL,
 PRIMARY KEY(IDE_HAB)
)ENGINE = InnoDB;

INSERT INTO HABITACION VALUES(NULL, 'A', 'B', 1 , 1, 35);
INSERT INTO HABITACION VALUES(NULL, 'A', 'B', 2 , 1, 35);
INSERT INTO HABITACION VALUES(NULL, 'A', 'B', 3 , 1, 35);
INSERT INTO HABITACION VALUES(NULL, 'A', 'B', 4 , 1, 35);


CREATE TABLE CARGO(
IDE_CAR INT NOT NULL auto_increment,
DES_CAR VARCHAR(30) NOT NULL,
PRIMARY KEY(IDE_CAR)
)ENGINE = InnoDB;

INSERT INTO CARGO (DES_CAR) VALUES ('Recepcionista'), ('Administrador'), ('Ser. Limpieza'), ('Gerente');

CREATE TABLE TIPODOC(
IDE_TDO INT NOT NULL auto_increment,
DES_TDO VARCHAR(30) NOT NULL,
PRIMARY KEY(IDE_TDO)
)ENGINE = InnoDB;

INSERT INTO TIPODOC (DES_TDO) VALUES ('DNI'), ('Pasaporte'), ('Carnet de Extranjeria');

CREATE TABLE EMPLEADO (
 IDE_EMP INT NOT NULL auto_increment,
 APE_EMP VARCHAR(50) NOT NULL,
 NOM_EMP VARCHAR(50) NOT NULL,
 FON_EMP VARCHAR(15) NULL,
 IDE_TDO INT REFERENCES TIPODOC,
 NDO_EMP INT NOT NULL,
 EMA_EMP VARCHAR(50) NOT NULL,
 IDE_CAR INT REFERENCES CARGO,
 PRIMARY KEY(IDE_EMP),
 FOREIGN KEY(IDE_CAR) REFERENCES CARGO(IDE_CAR),
 FOREIGN KEY(IDE_TDO) REFERENCES TIPODOC(IDE_TDO)
)ENGINE = InnoDB;

INSERT INTO EMPLEADO (APE_EMP, NOM_EMP, FON_EMP, IDE_TDO, NDO_EMP, EMA_EMP, IDE_CAR)
VALUES 
('Pérez', 'María', '987654321', 1, 45871236, 'maria.perez@hotel.com', 1),
('Gómez', 'Luis', '912345678', 1, 47895612, 'luis.gomez@hotel.com', 2),
('Torres', 'Elena', '956784321', 1, 42589631, 'elena.torres@hotel.com', 3),
('Ramírez', 'Carlos', '934562178', 1, 43896512, 'carlos.ramirez@hotel.com', 4),
('Sánchez', 'Julia', '998712345', 1, 40123589, 'julia.sanchez@hotel.com', 1);


CREATE TABLE CLIENTE (
 IDE_CLI INT NOT NULL auto_increment,
 APE_CLI VARCHAR(50) NOT NULL,
 NOM_CLI VARCHAR(50) NOT NULL,
 IDE_TDO INT NOT NULL,
 NDO_CLI INT NOT NULL,
 NAC_CLI VARCHAR(10) NOT NULL, 
 EMA_CLI VARCHAR(50) NOT NULL,
 FON_CLI VARCHAR(15) NULL,
 PRIMARY KEY(IDE_CLI),
 FOREIGN KEY(IDE_TDO) REFERENCES TIPODOC(IDE_TDO)
)ENGINE = InnoDB; 

INSERT INTO CLIENTE VALUES(NULL, 'A', 'B', 1 , 12344, 'PERU', '123@GMAIL.COM', '783927892323');

CREATE TABLE RESERVA(
IDE_RES INT NOT NULL auto_increment,
IDE_CLI INT NOT NULL,
FEN_RES DATE NOT NULL,
FSA_RES DATE NOT NULL,
NNO_RES INT NOT NULL,
MTO_RES DECIMAL(10,2),
IDE_HAB INT REFERENCES HABITACION,
PRIMARY KEY(IDE_RES,IDE_HAB,IDE_CLI) ,
FOREIGN KEY(IDE_HAB) REFERENCES HABITACION(IDE_HAB),
FOREIGN KEY(IDE_CLI) REFERENCES CLIENTE(IDE_CLI)
)ENGINE = InnoDB;


CREATE TABLE CHECKIN(
IDE_CHE INT NOT NULL auto_increment,
  IDE_RES INT NOT NULL,
  FCH_CHE DATE NOT NULL,
  OPA_CHE VARCHAR(10) NOT NULL,
  PVE_CHE VARCHAR(8),
  NAC_CHE INT NOT NULL,
  PRIMARY KEY(IDE_CHE,IDE_RES) ,
  FOREIGN KEY(IDE_RES) REFERENCES RESERVA(IDE_RES) 
)ENGINE = InnoDB;

CREATE TABLE SERVICIO(
IDE_SER INT NOT NULL auto_increment,
DES_SER VARCHAR(30) NOT NULL,
 PRIMARY KEY(IDE_SER)
)ENGINE = InnoDB;

CREATE TABLE CONSUMO (
IDE_COM INT NOT NULL auto_increment,
IDE_HAB int NOT NULL,
IDE_RES int NOT NULL,
IDE_SER int NOT NULL,
MTO_COM decimal(10,2),
PRIMARY KEY(IDE_COM,IDE_HAB,IDE_RES) ,
FOREIGN KEY(IDE_RES) REFERENCES RESERVA(IDE_RES), 
FOREIGN KEY(IDE_SER) REFERENCES SERVICIO(IDE_SER), 
FOREIGN KEY(IDE_HAB) REFERENCES HABITACION(IDE_HAB) 
)ENGINE = InnoDB;

CREATE TABLE CHECKOUT(
IDE_OUT INT NOT NULL auto_increment,
IDE_RES INT NOT NULL,
FCH_OUT DATE NOT NULL,
OPA_OUT VARCHAR(10) NOT NULL,
PVE_OUT VARCHAR(8),
NAC_OUT INT NOT NULL,
IDE_COM INT NOT NULL,
PRIMARY KEY(IDE_OUT,IDE_RES) ,
FOREIGN KEY(IDE_RES) REFERENCES RESERVA(IDE_RES), 
FOREIGN KEY(IDE_COM) REFERENCES CONSUMO(IDE_COM) 
)ENGINE = InnoDB;

SELECT * FROM HABITACION;

SELECT * FROM EMPLEADO;
SELECT * FROM RESERVA;